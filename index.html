<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate Secret Pet Hatch Calculator</title>
<style>
body {margin:0;font-family:Arial,sans-serif;background:#0f0f14;color:#eaeaea;display:flex;justify-content:center;padding:20px;transition:background 0.3s,color 0.3s;}
body.light {background:#f0f0f5;color:#111;}
.container {width:100%;max-width:750px;}
.announcement {background:#1f2937;border:1px solid #00aaff;color:#cfefff;padding:10px;border-radius:10px;text-align:center;margin-bottom:15px;font-size:14px;}
.tabs {display:flex;justify-content:space-around;margin-bottom:15px;}
.tab {cursor:pointer;padding:10px 15px;border-radius:8px;background:#1c1c26;transition:0.2s;}
.tab.active {background:#00aaff;font-weight:bold;color:#fff;}
.section {display:none;background:#1c1c26;padding:20px;border-radius:12px;}
.section.active {display:block;}
.inputs {display:grid;grid-template-columns:1fr 1fr;gap:10px 20px;margin-bottom:15px;}
.input-group {display:flex;flex-direction:column;}
.input-group label {font-size:13px;margin-bottom:3px;}
.input-group input, select {padding:6px;font-size:14px;border-radius:5px;border:1px solid #333;background:#0f0f14;color:#eaeaea;}
.input-group input:focus {background:#1a1a28;outline:none;}
button {padding:10px;font-size:16px;border:none;border-radius:8px;cursor:pointer;background:linear-gradient(90deg,#00aaff,#0066cc);color:#fff;font-weight:bold;margin-top:5px;transition:0.2s;}
button:hover {background:linear-gradient(90deg,#00ccff,#004c99);}
pre {margin-top:10px;white-space:pre-wrap;font-size:14px;background:#0f0f14;padding:10px;border-radius:5px;border:1px solid #333;}
.info {position:relative;cursor:pointer;color:#00aaff;margin-left:4px;font-weight:bold;}
.tooltip {visibility:hidden;width:280px;background:#333;color:#fff;text-align:left;border-radius:6px;padding:8px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-140px;opacity:0;transition:0.3s;font-size:12px;}
.info:hover .tooltip {visibility:visible;opacity:1;}
.feedback {text-align:center;margin-top:5px;}
.feedback a {color:#00aaff;text-decoration:none;font-size:13px;}
.signature {text-align:center;font-size:12px;margin-top:10px;color:#888;}
.progress-container {position:relative;height:18px;background:#1c1c26;border-radius:8px;margin:3px 0 8px 0;overflow:hidden;}
.progress-bar {height:100%;border-radius:8px;transition:width 0.2s;}
.progress-bar.expected {position:absolute;top:0;left:0;height:100%;border-radius:8px;opacity:0.5;background-color:#ffaa00;}
.mini-icon {margin-right:5px;}
.fast-mode {grid-column:1/-1;}
@media(max-width:600px){.inputs{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="container">

<div class="announcement" id="announcementBox"></div>

<div style="text-align:center;margin-bottom:10px;">
<button id="toggleTheme">üåô Toggle Light/Dark Mode</button>
</div>

<div class="tabs">
  <div class="tab active" data-tab="single">Single Pet Calculator</div>
  <div class="tab" data-tab="multi">Multi-Egg Odds</div>
  <div class="tab" data-tab="sim">Hatch Simulator</div>
</div>

<!-- SINGLE PET CALCULATOR -->
<div class="section active" id="single">
  <div class="inputs">
    <div class="input-group">
      <label>Base Rarity üê£ <span class="info">‚Ñπ<small class="tooltip">Chances of the pet (supports 1/25k, 0.0002%, or "x x x" multiplier format)</small></span></label>
      <input id="baseRarity" placeholder="1/25k, 25k, 0.0002% or '1 2 3'">
    </div>
    <div class="input-group">
      <label>Your Luck üçÄ <span class="info">‚Ñπ<small class="tooltip">Add up all your boosts. Event luck does not count.</small></span></label>
      <input id="yourLuck" placeholder="Add all potions, gamepass, purchasable luck">
    </div>
    <div class="input-group">
      <label>Event Luck üéâ <span class="info">‚Ñπ<small class="tooltip">Ongoing event multiplier. Type 1 if none.</small></span></label>
      <input id="eventLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Admin Abuse Luck üõ†Ô∏è <span class="info">‚Ñπ<small class="tooltip">Luck on the Admin Abuse egg type.</small></span></label>
      <input id="adminLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Eggs per Batch ü•ö <span class="info">‚Ñπ<small class="tooltip">Number of eggs per batch.</small></span></label>
      <input id="eggsBatch" type="number" placeholder="Number of eggs per batch">
    </div>
    <div class="input-group">
      <label>Hatch Speed ‚è±Ô∏è <span class="info">‚Ñπ<small class="tooltip">Normal hatch speed is 2.57 seconds per egg.</small></span></label>
      <input id="hatchSpeed" type="number" value="2.57">
    </div>
  </div>
  <button id="calcBtn">Calculate</button>
  <button id="copyBtn">üìã Copy Output</button>
  <pre id="output"></pre>
</div>

<!-- MULTI-EGG ODDS -->
<div class="section" id="multi">
  <div class="inputs">
    <div class="input-group" style="grid-column:1/-1;">
      <label>Egg Type ü•ö</label>
      <select id="eggSelect"></select>
    </div>
    <div class="input-group">
      <label>Your Luck üçÄ</label>
      <input id="multiYourLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Event Luck üéâ</label>
      <input id="multiEventLuck" type="number" value="1">
    </div>
  </div>
  <button id="multiCalcBtn">Calculate Multi-Odds</button>
  <button id="multiCopyBtn">üìã Copy Output</button>
  <pre id="multiOutput"></pre>
</div>

<!-- HATCH SIMULATOR -->
<div class="section" id="sim">
  <div class="inputs">
    <div class="input-group">
      <label>Egg Type ü•ö</label>
      <select id="simEggSelect"></select>
    </div>
    <div class="input-group">
      <label>Your Luck üçÄ</label>
      <input id="simYourLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Event Luck üéâ</label>
      <input id="simEventLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Admin Abuse Luck üõ†Ô∏è</label>
      <input id="simAdminLuck" type="number" value="1">
    </div>
    <div class="input-group">
      <label>Batches to Simulate üê£ <span class="info">‚Ñπ<small class="tooltip">How many batches to simulate. Ex: 1000.</small></span></label>
      <input id="simBatches" type="number" value="100">
    </div>
    <div class="input-group fast-mode">
      <label><input type="checkbox" id="fastMode"> Fast Hatch Mode (skip animation)</label>
    </div>
  </div>
  <button id="simBtn">Simulate Hatches</button>
  <button id="simCopyBtn">üìã Copy Output</button>
  <pre id="simOutput"></pre>
</div>

<div class="feedback"><a href="https://forms.gle/TbxWf1RvkZz3TZxo6" target="_blank">üí¨ Feedback</a></div>
<div class="signature">By: iQovz</div>

</div>

<script>
// ================== ANNOUNCEMENT ==================
const ANNOUNCEMENT_TEXT = "üî• Ultimate Pet Calculator Updated! Try multipliers, animated simulator & rare pet effects!";
document.getElementById('announcementBox').textContent = ANNOUNCEMENT_TEXT;

// ================== LIGHT/DARK TOGGLE ==================
document.getElementById('toggleTheme').onclick = () => document.body.classList.toggle('light');

// ================== TABS ==================
document.querySelectorAll('.tab').forEach(tab=>{
  tab.onclick = ()=>{
    document.querySelectorAll('.tab,.section').forEach(e=>e.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  };
});

// ================== HELPER ==================
function parseRarity(input){
  if(!input) return null;
  input=input.toLowerCase().replace(/,/g,'').trim();
  if(input.includes(' ')){
    let parts=input.split(' ').map(Number);
    if(parts.length===3) return 25000/parts[0]*parts[1]*parts[2]; // Example x x x multiplier
  }
  if(input.endsWith('%')) return Math.round(1/(Number(input.replace('%',''))/100));
  if(input.includes('/')){
    let denom=input.split('/')[1];
    if(denom.endsWith('k')) return Number(denom.replace('k',''))*1000;
    if(denom.endsWith('m')) return Number(denom.replace('m',''))*1_000_000;
    return Number(denom);
  }
  if(input.endsWith('k')) return Number(input.replace('k',''))*1000;
  if(input.endsWith('m')) return Number(input.replace('m',''))*1_000_000;
  let val = Number(input);
  if(val>0 && val<1) return Math.round(1/val);
  return val;
}

// ================== EGG DATA ==================
const eggsData = {
"Basic":[{name:"Dragon",chance:100,icon:"üêâ"},{name:"Royal Blob",chance:100000,icon:"üü£"}],
"Shark":[{name:"Shark",chance:100,icon:"ü¶à"}],
"Glacier":[{name:"Yeti",chance:52.63,icon:"‚ùÑÔ∏è"},{name:"Frost Dragon",chance:1000,icon:"üê≤"}],
"Mystic":[{name:"Taurus",chance:52.63,icon:"üêÇ"},{name:"Goblin",chance:1000,icon:"üëπ"},{name:"Mystic Hexo",chance:100000,icon:"‚ú®"}],
"Crystal":[{name:"Dominus",chance:1000,icon:"üëë"},{name:"Flying Gem",chance:100000,icon:"üíé"}],
"Blossom":[{name:"Blossom Dominus",chance:1000,icon:"üå∏"},{name:"Flower Trophy",chance:100000,icon:"üèÜ"},{name:"Eternal Flower",chance:500000,icon:"üå∫"}],
"Magic":[{name:"Clown",chance:25000,icon:"ü§°"}],
"Fire Ring":[{name:"Festival Bunny",chance:100,icon:"üê∞"},{name:"Festival Dragon",chance:1000,icon:"üêâ"},{name:"Fire Ring Lion",chance:100000,icon:"ü¶Å"},{name:"Ultra Dice",chance:500000,icon:"üé≤"}]
};

// ================== POPULATE SELECTS ==================
[document.getElementById('eggSelect'),document.getElementById('simEggSelect')].forEach(sel=>{
  Object.keys(eggsData).forEach(e=>{
    let o=document.createElement('option'); o.value=o.textContent=e; sel.appendChild(o);
  });
});

// ================== SINGLE CALCULATOR ==================
document.getElementById('calcBtn').onclick = () => {
  const base = parseRarity(document.getElementById('baseRarity').value);
  const yourLuck = Number(document.getElementById('yourLuck').value)||1;
  const eventLuck = Number(document.getElementById('eventLuck').value)||1;
  const adminLuck = Number(document.getElementById('adminLuck').value)||1;
  const eggs = Number(document.getElementById('eggsBatch').value);
  const hatchSpeed = Number(document.getElementById('hatchSpeed').value)||2.57;
  const output = document.getElementById('output');
  if(!base||!eggs){output.textContent="Please enter valid Base Rarity and Eggs per Batch.";return;}
  const totalLuck=yourLuck*eventLuck*adminLuck;
  const odds=base/totalLuck;
  const batches=odds/eggs;
  const totalTimeSec=batches*hatchSpeed;
  let displayTime;
  if(totalTimeSec<60) displayTime=totalTimeSec.toFixed(2)+' seconds';
  else if(totalTimeSec<3600) displayTime=(totalTimeSec/60).toFixed(2)+' minutes';
  else if(totalTimeSec<86400) displayTime=(totalTimeSec/3600).toFixed(2)+' hours';
  else displayTime=(totalTimeSec/86400).toFixed(2)+' days';
  output.textContent=
`Your Current Luck: ${totalLuck.toFixed(2)}x
Chances: 1/${Math.round(odds).toLocaleString()}
Time to Hatch: ~${displayTime}
Adjusted Hatch Time per Batch: ${hatchSpeed.toFixed(2)} seconds
Total Hatches Needed: ${Math.round(batches).toLocaleString()}`;
  // save last luck
  localStorage.setItem('yourLuck', yourLuck);
};
document.getElementById('copyBtn').onclick=()=>{navigator.clipboard.writeText(document.getElementById('output').textContent).then(()=>alert('Copied!'));};

// ================== MULTI-EGG ==================
document.getElementById('multiCalcBtn').onclick=()=>{
  const egg=document.getElementById('eggSelect').value;
  const luck=(+document.getElementById('multiYourLuck').value||1)*(+document.getElementById('multiEventLuck').value||1);
  document.getElementById('multiOutput').textContent = eggsData[egg].map(p=>`${p.icon} ${p.name}: 1/${Math.round(p.chance/luck).toLocaleString()}`).join('\n');
};
document.getElementById('multiCopyBtn').onclick=()=>{navigator.clipboard.writeText(document.getElementById('multiOutput').textContent).then(()=>alert('Copied!'));};

// ================== SIMULATOR ==================
document.getElementById('simBtn').onclick = async () => {
  const egg = document.getElementById('simEggSelect').value;
  const luck = (+document.getElementById('simYourLuck').value||1)*
               (+document.getElementById('simEventLuck').value||1)*
               (+document.getElementById('simAdminLuck').value||1);
  const batches = +document.getElementById('simBatches').value||100;
  const container = document.getElementById('simOutput'); 
  const fastMode = document.getElementById('fastMode').checked;
  container.innerHTML = '';

  const results = {}; 
  eggsData[egg].forEach(p => results[p.name] = 0);

  const maxResult = batches; // for bar scaling

  const animateStep = (i)=>{
    eggsData[egg].forEach(p => {if(Math.random()<luck/p.chance) results[p.name]++;});
    renderBars();
  };

  const renderBars = ()=>{
    container.innerHTML='';
    eggsData[egg].forEach(p=>{
      const count=results[p.name];
      const label = document.createElement('div'); 
      const expected = Math.round(batches/(p.chance/luck));
      label.innerHTML = `<span class="mini-icon">${p.icon}</span>${p.name}: ${count} / Expected: ${expected}`;
      container.appendChild(label);

      const barContainer = document.createElement('div'); 
      barContainer.className='progress-container';
      const bar=document.createElement('div'); 
      bar.className='progress-bar';
      let color = p.chance<=100?'#ff5555':p.chance<=1000?'#55aaff':'#55ff55';
      bar.style.backgroundColor=color;
      bar.style.width=Math.max(2,(count/maxResult)*100)+'%';
      barContainer.appendChild(bar);

      const expectedBar=document.createElement('div');
      expectedBar.className='progress-bar expected';
      expectedBar.style.width=Math.max(2,(expected/maxResult)*100)+'%';
      barContainer.appendChild(expectedBar);

      container.appendChild(barContainer);

      // Rare pet effect
      if(p.chance<=100 && count>0){
        const effect=document.createElement('div');
        effect.style.color='#ff0';
        effect.style.fontWeight='bold';
        effect.textContent='‚ú® Ultra Rare Hatch! ‚ú®';
        container.appendChild(effect);
      }
    });
  };

  if(fastMode){
    for(let i=0;i<batches;i
