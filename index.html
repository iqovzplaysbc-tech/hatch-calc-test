<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate Secret Pet Hatch Calculator</title>
<style>
body {margin:0;font-family:Arial,sans-serif;background:#0f0f14;color:#eaeaea;display:flex;justify-content:center;padding:20px;transition:background 0.3s,color 0.3s;}
body.light {background:#f0f0f5;color:#111;}
.container {width:100%;max-width:750px;}
.announcement {background:#1f2937;border:1px solid #00aaff;color:#cfefff;padding:10px;border-radius:10px;text-align:center;margin-bottom:15px;font-size:14px;}
body.light .announcement {background:#d0e8ff;color:#111;border:1px solid #00aaff;}
.tabs {display:flex;justify-content:space-around;margin-bottom:15px;}
.tab {cursor:pointer;padding:10px 15px;border-radius:8px;background:#1c1c26;transition:0.2s;}
body.light .tab {background:#d0d4e0;color:#111;}
.tab.active {background:#00aaff;font-weight:bold;color:#fff;}
body.light .tab.active {background:#0066cc;color:#fff;}
.section {display:none;background:#1c1c26;padding:20px;border-radius:12px;}
body.light .section {background:#e0e0e8;color:#111;}
.section.active {display:block;}
.inputs {display:grid;grid-template-columns:1fr 1fr;gap:10px 20px;margin-bottom:15px;}
.input-group {display:flex;flex-direction:column;}
.input-group label {font-size:13px;margin-bottom:3px;}
.input-group input, select {padding:6px;font-size:14px;border-radius:5px;border:1px solid #333;background:#0f0f14;color:#eaeaea;}
body.light .input-group input, body.light .input-group select {background:#fff;color:#111;border:1px solid #aaa;}
.input-group input:focus {background:#1a1a28;outline:none;}
body.light .input-group input:focus {background:#eef0f5;}
button {padding:10px;font-size:16px;border:none;border-radius:8px;cursor:pointer;background:linear-gradient(90deg,#00aaff,#0066cc);color:#fff;font-weight:bold;margin-top:5px;transition:0.2s;}
body.light button {background:linear-gradient(90deg,#0066cc,#00aaff);}
button:hover {background:linear-gradient(90deg,#00ccff,#004c99);}
pre {margin-top:10px;white-space:pre-wrap;font-size:14px;background:#0f0f14;padding:10px;border-radius:5px;border:1px solid #333;color:#fff;}
body.light pre {background:#f5f5f5;color:#111;border:1px solid #aaa;}
.info {position:relative;cursor:pointer;color:#00aaff;margin-left:4px;font-weight:bold;}
.tooltip {visibility:hidden;width:280px;background:#333;color:#fff;text-align:left;border-radius:6px;padding:8px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-140px;opacity:0;transition:0.3s;font-size:12px;}
body.light .tooltip {background:#111;color:#fff;}
.info:hover .tooltip {visibility:visible;opacity:1;}
.feedback {text-align:center;margin-top:5px;}
.feedback a {color:#00aaff;text-decoration:none;font-size:13px;}
.signature {text-align:center;font-size:12px;margin-top:10px;color:#888;}
.progress-container {position:relative;height:18px;background:#1c1c26;border-radius:8px;margin:3px 0 8px 0;overflow:hidden;}
body.light .progress-container {background:#d0d0d8;}
.progress-bar {height:100%;border-radius:8px;transition:width 0.2s;}
.progress-bar.expected {position:absolute;top:0;left:0;height:100%;border-radius:8px;opacity:0.5;background-color:#ffaa00;}
.fast-mode {grid-column:1/-1;}
@media(max-width:600px){.inputs{grid-template-columns:1fr;}}
.version{position:fixed;bottom:12px;right:14px;font-size:16px;font-weight:bold;color:#ffffff;opacity:0.75;pointer-events:none;}
body.light .version{color:#111;opacity:0.6;}
</style>
</head>
<body>
<div class="container">

<div class="announcement" id="announcementBox"></div>

<div style="text-align:center;margin-bottom:10px;">
<button id="toggleTheme">ğŸŒ™ Toggle Light/Dark Mode</button>
</div>

<div class="tabs">
  <div class="tab active" data-tab="single">Single Pet Calculator</div>
  <div class="tab" data-tab="multi">Multi-Egg Odds</div>
  <div class="tab" data-tab="sim">Hatch Simulator</div>
</div>

<!-- SINGLE CALCULATOR -->
<div class="section active" id="single">
  <div class="inputs">
    <div class="input-group">
      <label>Base Rarity ğŸ£ <span class="info">â„¹<small class="tooltip">Supports 1/25k, 0.0002%, or "x x x" multiplier</small></span></label>
      <input id="baseRarity" placeholder="1/25k, 25k, 0.0002% or '1 2 3'">
    </div>
    <div class="input-group">
      <label>Your Luck ğŸ€ <span class="info">â„¹<small class="tooltip">Add all luck multipliers from potions/upgrades. Do not include event luck here.</small></span></label>
      <input id="yourLuck" placeholder="Example: 1.5 + 2 + 3 = 6.5">
    </div>
    <div class="input-group"><label>Event Luck ğŸ‰</label><input id="eventLuck" type="number" value="1"></div>
    <div class="input-group"><label>Admin Abuse Luck ğŸ› ï¸</label><input id="adminLuck" type="number" value="1"></div>
    <div class="input-group"><label>Eggs per Batch ğŸ¥š</label><input id="eggsBatch" type="number"></div>
    <div class="input-group"><label>Base Hatch Speed â±ï¸</label><input id="hatchSpeed" type="number" value="2.57"></div>
    <div class="input-group"><label>Hatch Speed Multiplier ğŸš€</label><input id="speedMulti" placeholder="1x,2x,3x"></div>
  </div>
  <button id="calcBtn">Calculate</button>
  <button id="copyBtn">ğŸ“‹ Copy Output</button>
  <pre id="output"></pre>
</div>

<!-- MULTI-EGG ODDS -->
<div class="section" id="multi">
  <div class="inputs">
    <div class="input-group" style="grid-column:1/-1;">
      <label>Egg Type ğŸ¥š</label>
      <select id="eggSelect"></select>
    </div>
    <div class="input-group"><label>Your Luck ğŸ€</label><input id="multiYourLuck" type="number" value="1"></div>
    <div class="input-group"><label>Event Luck ğŸ‰</label><input id="multiEventLuck" type="number" value="1"></div>
  </div>
  <button id="multiCalcBtn">Calculate Multi-Odds</button>
  <button id="multiCopyBtn">ğŸ“‹ Copy Output</button>
  <pre id="multiOutput"></pre>
</div>

<!-- HATCH SIMULATOR -->
<div class="section" id="sim">
  <div class="inputs">
    <div class="input-group"><label>Egg Type ğŸ¥š</label><select id="simEggSelect"></select></div>
    <div class="input-group"><label>Your Luck ğŸ€</label><input id="simYourLuck" type="number" value="1"></div>
    <div class="input-group"><label>Event Luck ğŸ‰</label><input id="simEventLuck" type="number" value="1"></div>
    <div class="input-group"><label>Admin Abuse Luck ğŸ› ï¸</label><input id="simAdminLuck" type="number" value="1"></div>
    <div class="input-group"><label>Batches to Simulate ğŸ£</label><input id="simBatches" type="number" value="100"></div>
    <div class="input-group fast-mode"><label><input type="checkbox" id="fastMode"> Fast Hatch Mode</label></div>
  </div>
  <button id="simBtn">Simulate Hatches</button>
  <button id="simCopyBtn">ğŸ“‹ Copy Output</button>
  <pre id="simOutput"></pre>
</div>

<div class="feedback"><a href="https://forms.gle/TbxWf1RvkZz3TZxo6" target="_blank">ğŸ’¬ Feedback</a></div>
<div class="signature">By: iQovz</div>
<div class="version">v3.5</div>

<script>
window.addEventListener('DOMContentLoaded',()=>{

document.getElementById('announcementBox').textContent =
"ğŸ”¥If you have ideas, use feedback. Hatch Blossom and Jester eggs before secret pets vanish!";

document.querySelectorAll('.tab').forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll('.tab,.section').forEach(e=>e.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  };
});

document.getElementById('toggleTheme').onclick=()=>document.body.classList.toggle('light');

const eggsData={
"Basic":[{name:"Dragon",chance:100},{name:"Royal Blob",chance:100000}],
"Shark":[{name:"Shark",chance:100}],
"Glacier":[{name:"Yeti",chance:52.63},{name:"Frost Dragon",chance:1000}],
"Mystic":[{name:"Taurus",chance:52.63},{name:"Goblin",chance:1000},{name:"Mystic Hexo",chance:100000}],
"Crystal":[{name:"Dominus",chance:1000},{name:"Flying Gem",chance:100000}],
"Blossom":[{name:"Blossom Dominus",chance:1000},{name:"Flower Trophy",chance:100000},{name:"Eternal Flower",chance:500000}],
"Magic":[{name:"Clown",chance:25000}],
"Fire Ring":[{name:"Festival Bunny",chance:100},{name:"Festival Dragon",chance:1000},{name:"Fire Ring Lion",chance:100000},{name:"Ultra Dice",chance:500000}],
"Jester":[{name:"Pink Cotton Candy",chance:100},{name:"Blue Cotton Candy",chance:1000},{name:"Popcorn",chance:250000},{name:"Flying Jester",chance:1000000}]
};

[eggSelect,simEggSelect].forEach(sel=>{
  Object.keys(eggsData).forEach(e=>{
    let o=document.createElement('option'); o.value=e; o.textContent=e; sel.appendChild(o);
  });
});

// Helpers
function parseRarity(input){
  if(!input) return null;
  input=input.toLowerCase().replace(/,/g,'').trim();
  if(input.includes(' ')){let p=input.split(' ').map(Number); if(p.length===3) return Math.round(25000/p[0]*p[1]*p[2]);}
  if(input.endsWith('%')) return Math.round(1/(Number(input.replace('%',''))/100));
  if(input.includes('/')){let d=input.split('/')[1]; if(d.endsWith('k')) return Number(d.replace('k',''))*1000; if(d.endsWith('m')) return Number(d.replace('m',''))*1e6; return Number(d);}
  if(input.endsWith('k')) return Number(input.replace('k',''))*1000;
  if(input.endsWith('m')) return Number(input.replace('m',''))*1e6;
  let val=Number(input); if(val>0 && val<1) return Math.round(1/val); return val;
}
function parseMulti(v){if(!v)return 1;v=v.toLowerCase().replace('x','');let n=parseFloat(v);return(!n||n<=0)?1:n;}

// SINGLE CALCULATOR
calcBtn.onclick=()=>{
  const base=parseRarity(baseRarity.value);
  const yourLuck=Number(yourLuck.value)||1;
  const eventLuck=Number(eventLuck.value)||1;
  const adminLuck=Number(adminLuck.value)||1;
  const eggs=Number(eggsBatch.value);
  const speed=(Number(hatchSpeed.value)||2.57)/parseMulti(speedMulti.value);
  const out=document.getElementById('output');
  if(!base||!eggs){out.textContent="Enter valid Base Rarity & Eggs per Batch"; return;}
  const luck=yourLuck*eventLuck*adminLuck;
  const odds=base/luck;
  const batches=odds/eggs;
  const totalSec=batches*speed;
  let display;
  if(totalSec<60) display=totalSec.toFixed(2)+' sec';
  else if(totalSec<3600) display=(totalSec/60).toFixed(2)+' min';
  else if(totalSec<86400) display=(totalSec/3600).toFixed(2)+' hrs';
  else display=(totalSec/86400).toFixed(2)+' days';
  out.textContent=`Luck: ${luck.toFixed(2)}x
Chances: 1/${Math.round(odds).toLocaleString()}
Time: ~${display}
Per Batch Speed: ${speed.toFixed(2)} sec
Batches Needed: ${Math.round(batches).toLocaleString()}`;
};
copyBtn.onclick=()=>{navigator.clipboard.writeText(output.textContent).then(()=>alert('Copied!'));};

// MULTI
multiCalcBtn.onclick=()=>{
  const egg=eggSelect.value;
  const luck=(+multiYourLuck.value||1)*(+multiEventLuck.value||1);
  multiOutput.textContent=eggsData[egg].map(p=>`${p.name}: 1/${Math.round(p.chance/luck).toLocaleString()}`).join('\n');
};
multiCopyBtn.onclick=()=>{navigator.clipboard.writeText(multiOutput.textContent).then(()=>alert('Copied!'));};

// SIMULATOR
let simRunId=0;
simBtn.onclick=async()=>{
  simRunId++;
  const run=simRunId;
  const egg=simEggSelect.value;
  const luck=(+simYourLuck.value||1)*(+simEventLuck.value||1)*(+simAdminLuck.value||1);
  const batches=+simBatches.value||100;
  const fast=document.getElementById('fastMode').checked;
  const container=document.getElementById('simOutput'); container.innerHTML='';
  const results={}; eggsData[egg].forEach(p=>results[p.name]=0);
  const expected={}; eggsData[egg].forEach(p=>expected[p.name]=Math.round(batches/(p.chance/luck)));

  const render=()=>{
    if(run!==simRunId) return;
    container.innerHTML='';
    eggsData[egg].forEach(p=>{
      const count=results[p.name];
      const label=document.createElement('div'); label.textContent=`${p.name}: ${count} / Expected: ${expected[p.name]}`;
      container.appendChild(label);
      const barC=document.createElement('div'); barC.className='progress-container';
      const bar=document.createElement('div'); bar.className='progress-bar'; bar.style.backgroundColor=p.chance<=100?'#ff5555':p.chance<=1000?'#55aaff':'#55ff55'; bar.style.width=Math.max(2,(count/batches)*100)+'%';
      barC.appendChild(bar);
      const expBar=document.createElement('div'); expBar.className='progress-bar expected'; expBar.style.width=Math.max(2,(expected[p.name]/batches)*100)+'%'; expBar.style.backgroundColor='#ffaa00';
      barC.appendChild(expBar);
      container.appendChild(barC);
    });
  };

  if(fast){
    for(let i=0;i<batches;i++){eggsData[egg].forEach(p=>{if(Math.random()<(1/(p.chance/luck))) results[p.name]++;});}
    render();
  }else{
    for(let i=0;i<batches;i++){
      if(run!==simRunId) return;
      eggsData[egg].forEach(p=>{if(Math.random()<(1/(p.chance/luck))) results[p.name]++;});
      render(); await new Promise(r=>setTimeout(r,10));
    }
  }
};
simCopyBtn.onclick=()=>{navigator.clipboard.writeText(simOutput.textContent).then(()=>alert('Copied!'));};

});
</script>
</body>
</html>
